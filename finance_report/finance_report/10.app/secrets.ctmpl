{{- $env := env "ENV" -}}
{{- $env_suffix := "" -}}
{{- if ne $env "production" -}}
  {{- $env_suffix = printf "-%s" $env -}}
{{- end -}}
{{- with secret (printf "secret/data/finance_report/%s/postgres" $env) -}}
  {{- $pg_password := .Data.data.POSTGRES_PASSWORD }}
DATABASE_URL="{{ printf "postgresql+asyncpg://postgres:%s@finance_report-postgres%s:5432/finance_report" $pg_password $env_suffix }}"
{{ end -}}
{{- with secret (printf "secret/data/finance_report/%s/redis" $env) -}}
  {{- $redis_password := .Data.data.PASSWORD }}
REDIS_URL="{{ printf "redis://:%s@finance_report-redis%s:6379/0" $redis_password $env_suffix }}"
{{ end -}}
{{- with secret (printf "secret/data/finance_report/%s/app" $env) }}
ENVIRONMENT={{ with .Data.data.ENVIRONMENT }}{{ printf "%q" . }}{{ else }}"production"{{ end }}
DEBUG={{ with .Data.data.DEBUG }}{{ printf "%q" . }}{{ else }}"false"{{ end }}
BASE_CURRENCY={{ with .Data.data.BASE_CURRENCY }}{{ printf "%q" . }}{{ else }}"SGD"{{ end }}
OPENROUTER_API_KEY={{ with .Data.data.OPENROUTER_API_KEY }}{{ printf "%q" . }}{{ else }}""{{ end }}
PRIMARY_MODEL={{ with .Data.data.PRIMARY_MODEL }}{{ printf "%q" . }}{{ else }}"google/gemini-2.0-flash-exp:free"{{ end }}
FALLBACK_MODELS={{ with .Data.data.FALLBACK_MODELS }}{{ printf "%q" . }}{{ else }}"qwen/qwen-2.5-vl-7b-instruct:free,nvidia/nemotron-nano-12b-v2-vl:free"{{ end }}
OPENROUTER_DAILY_LIMIT_USD={{ with .Data.data.OPENROUTER_DAILY_LIMIT_USD }}{{ printf "%q" . }}{{ else }}"2"{{ end }}
S3_ENDPOINT={{ with .Data.data.S3_ENDPOINT }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_ACCESS_KEY={{ with .Data.data.S3_ACCESS_KEY }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_SECRET_KEY={{ with .Data.data.S3_SECRET_KEY }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_BUCKET={{ with .Data.data.S3_BUCKET }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_REGION={{ with .Data.data.S3_REGION }}{{ printf "%q" . }}{{ else }}"us-east-1"{{ end }}
S3_PRESIGN_EXPIRY_SECONDS={{ with .Data.data.S3_PRESIGN_EXPIRY_SECONDS }}{{ printf "%q" . }}{{ else }}"900"{{ end }}
S3_PUBLIC_ENDPOINT={{ with .Data.data.S3_PUBLIC_ENDPOINT }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_PUBLIC_ACCESS_KEY={{ with .Data.data.S3_PUBLIC_ACCESS_KEY }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_PUBLIC_SECRET_KEY={{ with .Data.data.S3_PUBLIC_SECRET_KEY }}{{ printf "%q" . }}{{ else }}""{{ end }}
S3_PUBLIC_BUCKET={{ with .Data.data.S3_PUBLIC_BUCKET }}{{ printf "%q" . }}{{ else }}""{{ end }}

SECRET_KEY={{ with .Data.data.SECRET_KEY }}{{ printf "%q" . }}{{ else }}""{{ end }}
CORS_ORIGINS={{ with .Data.data.CORS_ORIGINS }}{{ printf "%q" . }}{{ else }}""{{ end }}
NEXT_PUBLIC_APP_URL={{ with .Data.data.NEXT_PUBLIC_APP_URL }}{{ printf "%q" . }}{{ else }}""{{ end }}
OTEL_EXPORTER_OTLP_ENDPOINT={{ with .Data.data.OTEL_EXPORTER_OTLP_ENDPOINT }}{{ printf "%q" . }}{{ else }}""{{ end }}
OTEL_SERVICE_NAME={{ with .Data.data.OTEL_SERVICE_NAME }}{{ printf "%q" . }}{{ else }}""{{ end }}
OTEL_RESOURCE_ATTRIBUTES={{ with .Data.data.OTEL_RESOURCE_ATTRIBUTES }}{{ printf "%q" . }}{{ else }}""{{ end }}
{{- end }}
